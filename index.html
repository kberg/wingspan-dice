<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Wingspan Dice Tray</title>
<style>
  * { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #2c4a1e;
    color: #f5f0e1;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 20px;
  }

  h1 {
    font-size: 1.8rem;
    margin-bottom: 6px;
    letter-spacing: 1px;
    text-shadow: 1px 1px 3px rgba(0,0,0,0.4);
  }

  .subtitle {
    font-size: 0.9rem;
    opacity: 0.7;
    margin-bottom: 24px;
  }

  .options {
    margin-bottom: 16px;
    display: flex;
    justify-content: center;
  }

  .toggle {
    display: flex;
    align-items: center;
    gap: 10px;
    cursor: pointer;
    user-select: none;
    font-size: 0.9rem;
  }

  .toggle-track {
    width: 44px;
    height: 24px;
    background: #555;
    border-radius: 12px;
    position: relative;
    transition: background 0.2s;
  }

  .toggle-track.active {
    background: #d4a030;
  }

  .toggle-thumb {
    width: 20px;
    height: 20px;
    background: #fff;
    border-radius: 50%;
    position: absolute;
    top: 2px;
    left: 2px;
    transition: left 0.2s;
    box-shadow: 0 1px 3px rgba(0,0,0,0.3);
  }

  .toggle-track.active .toggle-thumb {
    left: 22px;
  }

  .tray {
    background: #3b2a1a;
    border: 4px solid #5a3d24;
    border-radius: 16px;
    padding: 30px 24px 24px;
    box-shadow: inset 0 2px 12px rgba(0,0,0,0.5), 0 4px 20px rgba(0,0,0,0.4);
    width: 100%;
    max-width: 560px;
  }

  .tray-label {
    font-size: 0.75rem;
    text-transform: uppercase;
    letter-spacing: 1.5px;
    opacity: 0.5;
    margin-bottom: 10px;
    text-align: center;
  }

  .dice-area {
    display: flex;
    flex-wrap: wrap;
    gap: 14px;
    justify-content: center;
    min-height: 194px;
    margin-bottom: 20px;
    max-width: 298px;
    margin-left: auto;
    margin-right: auto;
    align-content: start;
  }

  .die {
    width: 90px;
    height: 90px;
    background: #eee8d5;
    border-radius: 14px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    border: 3px solid #ccc4b0;
    box-shadow: 2px 3px 6px rgba(0,0,0,0.3);
    transition: transform 0.15s, box-shadow 0.15s, opacity 0.3s;
    user-select: none;
    position: relative;
  }

  .die.hidden { display: none; }

  .die:hover {
    transform: translateY(-3px);
    box-shadow: 2px 6px 12px rgba(0,0,0,0.4);
  }

  .die:active { transform: scale(0.95); }

  .die .icon { font-size: 2rem; line-height: 1; }
  .die .combo .icon { font-size: 1.4rem; }

  .die .label {
    font-size: 0.55rem;
    color: #5a5040;
    font-weight: 600;
    text-transform: uppercase;
    margin-top: 4px;
    letter-spacing: 0.5px;
  }

  .die .combo {
    display: flex;
    gap: 4px;
    align-items: center;
  }

  .die .combo .slash {
    font-size: 1rem;
    color: #5a5040;
    font-weight: bold;
  }

  .die .single-icon { display: none; }
  .die .combo { display: none; }
  .die.is-single .single-icon { display: block; }
  .die.is-combo .combo { display: flex; }

  .die.removing {
    opacity: 0;
    transform: scale(0.5);
    pointer-events: none;
  }

  .die.rolling {
    animation: roll 0.4s ease-out;
  }

  @keyframes roll {
    0%   { transform: rotateX(0deg) scale(0.8); opacity: 0.5; }
    50%  { transform: rotateX(180deg) scale(1.05); }
    100% { transform: rotateX(360deg) scale(1); opacity: 1; }
  }

  .controls {
    display: flex;
    gap: 10px;
    justify-content: center;
    flex-wrap: wrap;
  }

  button {
    background: #6b8f3c;
    color: #fff;
    border: none;
    border-radius: 8px;
    padding: 10px 20px;
    font-size: 0.95rem;
    font-weight: 600;
    cursor: pointer;
    transition: background 0.2s;
    box-shadow: 0 2px 6px rgba(0,0,0,0.3);
  }

  button:hover { background: #7da844; }
  button:disabled { background: #555; cursor: default; opacity: 0.5; }

  button.secondary {
    background: #8b6f47;
  }
  button.secondary:hover { background: #a07d4f; }

  .outside-area {
    width: 100%;
    max-width: 560px;
    margin-top: 20px;
    background: #1e3514;
    border: 3px dashed #4a7a30;
    border-radius: 16px;
    padding: 20px 24px;
    min-height: 280px;
    display: flex;
    flex-direction: column;
  }

  .outside-area.empty {
    border-color: #3a5a28;
    opacity: 0.5;
  }

  .outside-label {
    font-size: 0.75rem;
    text-transform: uppercase;
    letter-spacing: 1.5px;
    opacity: 0.5;
    margin-bottom: 10px;
    text-align: center;
  }

  .outside-dice {
    display: flex;
    flex-wrap: wrap;
    gap: 14px;
    justify-content: center;
    min-height: 90px;
    align-items: start;
    align-content: start;
    margin-bottom: 14px;
    flex: 1;
  }

  .outside-dice .die {
    cursor: default;
    opacity: 0.85;
  }
  .outside-dice .die:hover {
    transform: none;
    box-shadow: 2px 3px 6px rgba(0,0,0,0.3);
  }

  .outside-controls {
    display: flex;
    gap: 10px;
    justify-content: center;
    flex-wrap: wrap;
  }

  .outside-area.empty .outside-controls { display: none; }

  .empty-msg {
    color: #a09080;
    font-style: italic;
    font-size: 0.95rem;
    padding: 30px 0;
    text-align: center;
    width: 100%;
    display: none;
  }

  .outside-dice .empty-msg {
    padding: 10px 0;
    color: #6a8a58;
  }

  .dice-area .empty-msg.visible { display: block; }
  .outside-dice .empty-msg.visible { display: block; }

  .info {
    margin-top: 16px;
    text-align: center;
    font-size: 0.8rem;
    opacity: 0.6;
    line-height: 1.5;
    max-width: 560px;
  }

  .status {
    text-align: center;
    font-size: 0.85rem;
    margin-bottom: 14px;
    min-height: 1.2em;
    color: #d4c9a8;
  }
</style>
</head>
<body>

<h1>Wingspan Bird Feeder</h1>
<p class="subtitle">Dice Tray Simulator</p>

<div class="options">
  <label class="toggle" onclick="toggleNectar()">
    <span>Nectar (Oceania)</span>
    <div class="toggle-track" id="nectar-toggle">
      <div class="toggle-thumb"></div>
    </div>
  </label>
</div>

<div class="tray">
  <div class="tray-label">Bird Feeder</div>
  <div class="status" id="status"></div>
  <div class="dice-area" id="dice-area">
    <div class="die hidden" data-index="0" onclick="takeDie(0)">
      <div class="single-icon"><span class="icon"></span></div>
      <div class="combo"><span class="icon c0"></span><span class="slash">/</span><span class="icon c1"></span></div>
      <div class="label"></div>
    </div>
    <div class="die hidden" data-index="1" onclick="takeDie(1)">
      <div class="single-icon"><span class="icon"></span></div>
      <div class="combo"><span class="icon c0"></span><span class="slash">/</span><span class="icon c1"></span></div>
      <div class="label"></div>
    </div>
    <div class="die hidden" data-index="2" onclick="takeDie(2)">
      <div class="single-icon"><span class="icon"></span></div>
      <div class="combo"><span class="icon c0"></span><span class="slash">/</span><span class="icon c1"></span></div>
      <div class="label"></div>
    </div>
    <div class="die hidden" data-index="3" onclick="takeDie(3)">
      <div class="single-icon"><span class="icon"></span></div>
      <div class="combo"><span class="icon c0"></span><span class="slash">/</span><span class="icon c1"></span></div>
      <div class="label"></div>
    </div>
    <div class="die hidden" data-index="4" onclick="takeDie(4)">
      <div class="single-icon"><span class="icon"></span></div>
      <div class="combo"><span class="icon c0"></span><span class="slash">/</span><span class="icon c1"></span></div>
      <div class="label"></div>
    </div>
    <div class="empty-msg">No dice in the feeder</div>
  </div>
  <div class="controls">
    <button onclick="rerollAll()">Reset Dice Tray</button>
  </div>
</div>

<div class="outside-area empty" id="outside-area">
  <div class="outside-label">Selected Dice</div>
  <div class="outside-dice" id="outside-dice">
    <div class="die hidden" data-index="0">
      <div class="single-icon"><span class="icon"></span></div>
      <div class="combo"><span class="icon c0"></span><span class="slash">/</span><span class="icon c1"></span></div>
      <div class="label"></div>
    </div>
    <div class="die hidden" data-index="1">
      <div class="single-icon"><span class="icon"></span></div>
      <div class="combo"><span class="icon c0"></span><span class="slash">/</span><span class="icon c1"></span></div>
      <div class="label"></div>
    </div>
    <div class="die hidden" data-index="2">
      <div class="single-icon"><span class="icon"></span></div>
      <div class="combo"><span class="icon c0"></span><span class="slash">/</span><span class="icon c1"></span></div>
      <div class="label"></div>
    </div>
    <div class="die hidden" data-index="3">
      <div class="single-icon"><span class="icon"></span></div>
      <div class="combo"><span class="icon c0"></span><span class="slash">/</span><span class="icon c1"></span></div>
      <div class="label"></div>
    </div>
    <div class="die hidden" data-index="4">
      <div class="single-icon"><span class="icon"></span></div>
      <div class="combo"><span class="icon c0"></span><span class="slash">/</span><span class="icon c1"></span></div>
      <div class="label"></div>
    </div>
    <div class="empty-msg visible">No dice selected yet</div>
  </div>
  <div class="outside-controls">
    <button onclick="rerollOutside()">Reroll Selected Dice</button>
  </div>
</div>

<div class="info">
  Click a die in the feeder to take it. Taken dice appear outside the tray.<br>
  Feeder dice auto-reroll when the feeder is empty.<br>
  You can reroll dice outside the tray at any time. Enable Oceania for nectar combo faces.
</div>

<script>
  // Base game die faces: 4 single-food faces, 1 rodent, and 1 worm/seed combo.
  var BASE_FACES = [
    { id: 'worm',      icon: 'ü™±', label: 'Worm' },
    { id: 'seed',      icon: 'üåæ', label: 'Seed' },
    { id: 'fish',      icon: 'üêü', label: 'Fish' },
    { id: 'berry',     icon: 'ü´ê', label: 'Fruit' },
    { id: 'mouse',     icon: 'üêÄ', label: 'Rodent' },
    { id: 'worm+seed', icon: null, label: 'Worm / Seed', combo: ['ü™±', 'üåæ'] },
  ];

  // Oceania expansion die faces: seed and fruit become combo faces with nectar.
  var NECTAR_FACES = [
    { id: 'worm',         icon: 'ü™±', label: 'Worm' },
    { id: 'seed+nectar',  icon: null, label: 'Seed / Nectar', combo: ['üåæ', 'üå∫'] },
    { id: 'fish',         icon: 'üêü', label: 'Fish' },
    { id: 'berry+nectar', icon: null, label: 'Fruit / Nectar', combo: ['ü´ê', 'üå∫'] },
    { id: 'mouse',        icon: 'üêÄ', label: 'Rodent' },
    { id: 'worm+seed',    icon: null, label: 'Worm / Seed', combo: ['ü™±', 'üåæ'] },
  ];

  var nectarEnabled = false; // Whether the Oceania expansion toggle is on.
  var dice = [];             // Faces currently in the bird feeder.
  var outside = [];          // Faces selected (taken out of the feeder).

  // Cache DOM references to the 5 pre-built die elements in each area,
  // as well as the empty-state messages. These are static HTML elements
  // that are shown/hidden and updated in place rather than recreated.
  var trayDice = document.querySelectorAll('#dice-area .die');
  var trayEmpty = document.querySelector('#dice-area .empty-msg');
  var outsideDice = document.querySelectorAll('#outside-dice .die');
  var outsideEmpty = document.querySelector('#outside-dice .empty-msg');
  var outsideArea = document.getElementById('outside-area');

  // Returns the active face set based on whether Oceania nectar is enabled.
  function getFaces() {
    return nectarEnabled ? NECTAR_FACES : BASE_FACES;
  }

  // Returns a random face from the active face set.
  function rollDie() {
    var faces = getFaces();
    return faces[Math.floor(Math.random() * faces.length)];
  }

  // Updates a pre-existing die DOM element to display a given face.
  // Toggles is-single/is-combo classes to show the correct icon layout,
  // and sets the text content of the icon and label elements.
  // When animate is true, the rolling CSS animation is triggered.
  function applyFace(el, face, animate) {
    el.classList.remove('hidden', 'rolling', 'removing', 'is-single', 'is-combo');
    if (animate) {
      // Reading offsetWidth forces a browser reflow. This is necessary because
      // removing and re-adding the 'rolling' class in the same frame would be
      // batched by the browser and the CSS animation would not retrigger.
      // The reflow between the remove and add makes the browser treat it as
      // a fresh animation.
      void el.offsetWidth;
      el.classList.add('rolling');
    }

    if (face.combo) {
      el.classList.add('is-combo');
      el.querySelector('.c0').textContent = face.combo[0];
      el.querySelector('.c1').textContent = face.combo[1];
    } else {
      el.classList.add('is-single');
      el.querySelector('.single-icon .icon').textContent = face.icon;
    }
    el.querySelector('.label').textContent = face.label;
  }

  // Toggles the Oceania expansion mode. Does not reroll existing dice;
  // the new face set takes effect on the next roll.
  function toggleNectar() {
    nectarEnabled = !nectarEnabled;
    document.getElementById('nectar-toggle').classList.toggle('active', nectarEnabled);
  }

  // Resets the entire dice tray: rolls 5 fresh dice into the feeder
  // and clears the selected dice area.
  function rerollAll() {
    dice = Array.from({ length: 5 }, rollDie);
    outside = [];
    renderAll(true);
    updateStatus('');
  }

  // Removes a die from the feeder at the given index and moves it to
  // the selected area. Plays a shrink-out animation (300ms) before
  // updating state. If the feeder becomes empty, automatically rerolls
  // all 5 dice and clears selected after a 600ms delay.
  function takeDie(index) {
    trayDice[index].classList.add('removing');

    setTimeout(function() {
      var taken = dice.splice(index, 1)[0];
      outside.push(taken);
      renderAll(false);

      if (dice.length === 0) {
        updateStatus('Feeder is empty \u2014 rerolling!');
        setTimeout(function() {
          dice = Array.from({ length: 5 }, rollDie);
          outside = [];
          renderAll(true);
          updateStatus('');
        }, 600);
      }
    }, 300);
  }

  // Rerolls all selected dice in place (they stay outside the feeder).
  function rerollOutside() {
    outside = outside.map(function() { return rollDie(); });
    renderOutside(true);
  }

  // Sets the status message shown above the feeder dice.
  function updateStatus(msg) {
    document.getElementById('status').textContent = msg;
  }

  // Syncs the feeder's 5 pre-built die elements with the dice[] array.
  // Dice beyond the array length are hidden. Shows the empty message
  // when no dice remain.
  function renderTray(animate) {
    for (var i = 0; i < 5; i++) {
      if (i < dice.length) {
        applyFace(trayDice[i], dice[i], animate);
      } else {
        trayDice[i].classList.add('hidden');
      }
    }
    trayEmpty.classList.toggle('visible', dice.length === 0);
  }

  // Syncs the selected area's 5 pre-built die elements with the outside[]
  // array. Toggles the 'empty' class on the container, which controls
  // visibility of the reroll button via CSS.
  function renderOutside(animate) {
    for (var i = 0; i < 5; i++) {
      if (i < outside.length) {
        applyFace(outsideDice[i], outside[i], animate);
      } else {
        outsideDice[i].classList.add('hidden');
      }
    }
    outsideEmpty.classList.toggle('visible', outside.length === 0);
    outsideArea.classList.toggle('empty', outside.length === 0);
  }

  // Renders both the feeder tray and the selected dice area.
  function renderAll(animate) {
    renderTray(animate);
    renderOutside(animate);
  }

  rerollAll();
</script>
</body>
</html>
